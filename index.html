<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Preview Agentforce</title>
    <link rel="icon" href="data:,">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            text-align: center;
        }
        .logo {
            max-width: 250px;
            height: auto;
            margin-bottom: 20px;
        }
        .title {
            font-size: 22px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
        }
        .language-selector {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
        }
        .lang-btn {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            border: 2px solid #0070d2;
            background-color: white;
            color: #0070d2;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .lang-btn:hover {
            background-color: #0070d2;
            color: white;
        }
        .lang-btn.active {
            background-color: #0070d2;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Logo -->
    <img src="bobbio_logo.png" alt="Logo Azienda" class="logo">
    
    <!-- Testo -->
    <div class="title">TEST Agentforce</div>
    
    <!-- Selettore Lingua -->
    <div class="language-selector">
        <button class="lang-btn active" onclick="changeLanguage('it')" id="btn-it">ðŸ‡®ðŸ‡¹ Italiano</button>
        <button class="lang-btn" onclick="changeLanguage('en')" id="btn-en">ðŸ‡¬ðŸ‡§ English</button>
    </div>
 
    <script type="text/javascript">
        let currentLanguage = 'it';
        let isInitialized = false;

        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Aggiorna lo stile dei bottoni
            document.getElementById('btn-it').classList.toggle('active', lang === 'it');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            
            // Reinizializza il widget con la nuova lingua
            if (isInitialized && typeof embeddedservice_bootstrap !== 'undefined') {
                // Rimuovi il widget esistente (se presente)
                const existingWidget = document.querySelector('[data-test-id="embeddedMessagingFrame"]');
                if (existingWidget) {
                    existingWidget.remove();
                }
                
                // Reinizializza
                initEmbeddedMessaging();
            }
        }

        function initEmbeddedMessaging() {
            try {
                const language = currentLanguage;
                const labelText = language === 'en' ? 'Need help?' : 'Serve aiuto?';
                
                // Imposta la lingua
                embeddedservice_bootstrap.settings.language = language;
                
                embeddedservice_bootstrap.init(
                    "00DKB0000014aXF",                
                    "Web",                             
                    "https://pianidibobbio.my.site.com/ESWWebtest1763410614711", 
                    {
                        scrt2URL: "https://pianidibobbio.my.salesforce-scrt.com",
                        // PERSONALIZZAZIONE LAUNCHER
                        branding: {
                            launcher: {
                                label: labelText,
                                iconURL: "https://pianidibobbio.file.force.com/sfc/dist/version/renditionDownload?rendition=ORIGINAL_Jpg&versionId=068KB000006Bg5z&operationContext=DELIVERY&contentId=05TKB00000cW6Zd&page=0&d=/a/KB000000oQmX/rf61g94muITSDNRmmLNR7mVLk8Bq0k3Y1gXLZ_jPoAY&oid=00DKB0000014aXF&dpt=null&viewId=", 
                                iconSize: "large",
                                position: "right",       
                                rounded: true            
                            },
                            // COLORI DEL BOTTONE E TESTO
                            colors: {
                                brandPrimary: "#0070d2",
                                brandSecondary: "#005fb2",
                                launcherBackground: "#0070d2",
                                launcherText: "#ffffff"
                            }
                        }
                    }
                );
                
                isInitialized = true;
            } catch (err) {
                console.error("Errore Embedded Service Web v2:", err);
            }
        }
    </script>
    
    <script 
        type="text/javascript" 
        src="https://pianidibobbio.my.site.com/ESWWebtest1763410614711/assets/js/bootstrap.min.js" 
        onload="initEmbeddedMessaging()">
    </script>
</body>
</html>
